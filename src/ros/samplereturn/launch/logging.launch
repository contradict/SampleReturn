<?xml version="1.0"?>
<!-- vim: set fenc=utf-8 et sts=4 ft=xml : -->
<launch>

  <!-- platform node -->
  <node pkg="platform_motion" type="motion_node" name="motion" output="screen"/>

  <!-- rosbag record -->
  <node pkg="rosbag" type="record" name="record" output="screen" args="odometry stereo/right/image_raw stereo/left/image_raw stereo/right/camera_info stereo/left/camera_info"/>

  <!-- joy node -->
  <node respawn="true" pkg="joy"
        type="joy" name="joy" >
    <param name="dev" type="string" value="/dev/input/js0" />
    <param name="deadzone" value="0.05" />
  </node>

 <!-- Axes -->
  <param name="axis_linear" value="1" type="int"/>
  <param name="axis_angular" value="0" type="int"/>
  <param name="scale_linear" value="2" type="double"/>
  <param name="scale_angular" value="3.14/2" type="double"/>

  <node pkg="platform_motion" type="teleop" name="teleop"/>

    <!-- IEEE1394 camera driver -->
    <!-- Nodelet Host process -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="camera_process"
        args="manager"
        output="screen"
        >
    </node>
    <node
         pkg="nodelet"
         type="nodelet"
         name="left"
         args="load camera1394/driver /camera_process"
         ns="/stereo">

        <param name="guid" type="string" value="00b09d0100a8563d"/>
        <param name="video_mode" value="640x480_mono8"/>
        <param name="frame_id" value="navigation_stereo"/>
        <param name="frame_rate" value="15"/>
        <param name="bayer_pattern" value="rggb"/>
        <param name="camera_info_url"
               type="string"
               value="file://$(find samplereturn)/calibration/ffmv-left.yaml" />
        <remap from="camera" to="left" />
    </node>
    <node
         pkg="nodelet"
         type="nodelet"
         name="right"
         args="load camera1394/driver /camera_process"
         ns="/stereo">

        <param name="guid" type="string" value="00b09d0100a8566e"/>
        <param name="video_mode" value="640x480_mono8"/>
        <param name="frame_id" value="navigation_stereo"/>
        <param name="frame_rate" value="15"/>
        <param name="bayer_pattern" value="rggb"/>
        <param name="camera_info_url"
               type="string"
               value="file://$(find samplereturn)/calibration/ffmv-right.yaml" />
        <remap from="camera" to="right" />
    </node>

    <!-- Debayer -->
    <node pkg="nodelet"
          type="nodelet"
          name="debayer_left"
          args="load image_proc/debayer /camera_process"
          ns="/stereo/left">
    </node>
    <node pkg="nodelet"
          type="nodelet"
          name="debayer_right"
          args="load image_proc/debayer /camera_process"
          ns="/stereo/right">
    </node>

    <!-- Display images -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="left_display"
        args="load image_view/image /camera_process"
        ns="/stereo/left">

        <remap  from="image" to="image_mono"/>
    </node>
    <node
        pkg="nodelet"
        type="nodelet"
        name="right_display"
        args="load image_view/image /camera_process"
        ns="/stereo/right">

        <remap from="image" to="image_color"/>
    </node>


</launch>
